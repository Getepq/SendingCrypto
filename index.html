<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SendingCrypto Bot</title>
  <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/5/53/TON_symbol_blue.svg">
  <style>
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: radial-gradient(ellipse at top, #0f1321, #05070c);
      color: white;
      overflow-x: hidden;
    }

    .glass {
      background: rgba(20, 20, 35, 0.8);
      backdrop-filter: blur(25px);
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
    }

    .btn-glow {
      transition: all 0.2s ease;
      box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
    }

    .btn-glow:hover {
      box-shadow: 0 0 30px rgba(168, 85, 247, 0.5);
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(100px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Toast */
    #toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(30, 30, 40, 0.95);
      color: #fff;
      padding: 14px 24px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
      font-size: 14px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 100;
    }

    #toast.show {
      opacity: 1;
      pointer-events: auto;
    }
  </style>
</head>

<body>

  <!-- Основной интерфейс -->
  <main class="flex flex-col items-center justify-center min-h-screen text-center px-6">
    <div class="glass rounded-2xl p-6 w-full max-w-md">
      <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/TON_symbol_blue.svg" alt="TON" class="w-10 h-10 mx-auto mb-2 opacity-80">
      <h2 id="user-name" class="text-lg font-semibold mb-1">Гость</h2>
      <p class="text-gray-400 mb-5">Общий баланс в USD</p>
      <div class="text-3xl font-bold mb-6">$0</div>

      <div class="grid grid-cols-4 gap-3 text-sm">
        <button class="glass py-3 rounded-xl">Пополнить</button>
        <button class="glass py-3 rounded-xl">Вывести</button>
        <button class="glass py-3 rounded-xl">Обмен</button>
        <button class="glass py-3 rounded-xl">Биржа</button>
      </div>
    </div>
  </main>

  <!-- Toast -->
  <div id="toast">Кошелёк подключён ✅</div>

  <!-- Модал подключения TON -->
  <div id="ton-modal" class="fixed inset-0 bg-black/40 flex justify-center items-end z-50 hidden">
    <div class="glass w-full max-w-sm rounded-t-2xl p-6 pb-8 relative animate-[fadeIn_0.4s_ease_forwards]">

      <!-- Закрыть -->
      <button id="close-modal" class="absolute top-4 right-4 p-2 rounded-full hover:bg-white/10">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>

      <!-- Иконка -->
      <div class="flex justify-center mb-4">
        <div class="w-14 h-14 rounded-full bg-blue-500/20 flex items-center justify-center">
          <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/TON_symbol_blue.svg" alt="TON" class="w-8 h-8">
        </div>
      </div>

      <!-- Текст -->
      <div class="text-center">
        <div class="text-lg font-semibold mb-2">Подключить TON кошелёк</div>
        <p class="text-sm text-white/70 mb-6">
          Подключив кошелёк, вы сможете использовать TON-адрес для переводов и авторизации. Можно пропустить.
        </p>
      </div>

      <!-- Кнопки -->
      <div class="space-y-3">
        <button id="auth-ton" class="w-full py-3 bg-purple-500 hover:bg-purple-600 rounded-xl font-medium btn-glow">
          Подключить TON кошелёк
        </button>
        <button id="skip-auth" class="w-full py-3 bg-white/5 hover:bg-white/10 rounded-xl font-medium text-white/70">
          Пропустить
        </button>
      </div>
    </div>
  </div>

  <!-- TON SDK -->
  <script src="https://unpkg.com/@tonconnect/sdk@2.0.9/dist/tonconnect-sdk.min.js"></script>

  <script>
    const tonModal = document.getElementById('ton-modal');
    const closeModal = document.getElementById('close-modal');
    const authBtn = document.getElementById('auth-ton');
    const skipBtn = document.getElementById('skip-auth');
    const toast = document.getElementById('toast');
    const userName = document.getElementById('user-name');

    // Инициализация TonConnect
    const connector = new TON_CONNECT.TonConnect({
      manifestUrl: 'https://sending-crypto.vercel.app/tonconnect-manifest.json'
    });

    // Проверка сохранённого кошелька
    const savedWallet = localStorage.getItem('tonWalletAddress');

    window.addEventListener('load', async () => {
      if (savedWallet) {
        userName.textContent = savedWallet.slice(0, 6) + '...' + savedWallet.slice(-4);
        return; // уже подключён, не показываем окно
      }
      tonModal.classList.remove('hidden');
    });

    closeModal.addEventListener('click', () => tonModal.classList.add('hidden'));
    skipBtn.addEventListener('click', () => tonModal.classList.add('hidden'));

    // Подключение
    authBtn.addEventListener('click', async () => {
      try {
        const walletsList = await connector.getWallets();
        const wallet = walletsList[0];
        await connector.connect({ universalLink: wallet.universalLink, bridgeUrl: wallet.bridgeUrl });

        // если подключено
        if (connector.connected) {
          const account = connector.account.address;
          localStorage.setItem('tonWalletAddress', account);
          userName.textContent = account.slice(0, 6) + '...' + account.slice(-4);

          // звук
          const audio = new Audio('https://files.catbox.moe/yogz7u.mp3');
          audio.play();

          // вибрация
          if (navigator.vibrate) navigator.vibrate(100);

          // тост
          toast.classList.add('show');
          setTimeout(() => toast.classList.remove('show'), 2500);

          tonModal.classList.add('hidden');
        }

      } catch (err) {
        console.error('Ошибка подключения TON:', err);
      }
    });
  </script>
</body>
</html>
