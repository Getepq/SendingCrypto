<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
<title>SendingCrypto Bot</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
:root {
  --bg: #0f1724;
  --glass: rgba(23, 28, 46, 0.72);
  --border: rgba(255, 255, 255, 0.06);
  --muted: rgba(255,255,255,0.55);
  --accent: rgba(96,165,250,1);
}
html,body { height: 100%; }
body {
  background: linear-gradient(180deg, #0b1220 0%, #111827 100%);
  min-height: 100vh;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
  color: white;
  padding-bottom: 92px;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* Card glass */
.glass {
  background: var(--glass);
  backdrop-filter: blur(16px) saturate(150%);
  border: 1px solid var(--border);
  border-radius: 1rem;
  box-shadow: 0 10px 30px rgba(2,6,23,0.6);
  transition: transform .24s ease, box-shadow .24s ease, border-color .24s ease;
}

/* hover lift */
.glass:hover {
  transform: translateY(-4px);
  border-color: rgba(255,255,255,0.12);
  box-shadow: 0 18px 40px rgba(6,16,64,0.55);
}

/* Buttons */
.btn-glow {
  transition: all 0.24s ease;
}
.btn-glow:active { transform: scale(.98); }
.btn-primary {
  background: linear-gradient(90deg, rgba(96,165,250,0.14), rgba(59,130,246,0.16));
  border: 1px solid rgba(96,165,250,0.12);
  color: white;
  padding: 10px 16px;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 8px 24px rgba(59,130,246,0.08);
}
.btn-primary:hover {
  box-shadow: 0 14px 36px rgba(59,130,246,0.14);
  transform: translateY(-2px);
}

/* Panel */
#ton-panel { position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(4px); display: none; z-index: 9999; align-items: flex-end; justify-content: center; }
#ton-panel.active { display: flex; }
.panel-content { width: 100%; max-width: 520px; background: var(--glass); border-radius: 24px 24px 0 0; padding: 24px; box-shadow: 0 -6px 40px rgba(0,0,0,0.6); border: 1px solid var(--border); }

/* Balance glow */
#balance-amount {
  font-weight: 700;
  letter-spacing: -0.02em;
  transition: all .4s ease;
}
.balance-glow {
  text-shadow: 0 0 18px rgba(59,130,246,0.28), 0 6px 20px rgba(59,130,246,0.06);
  transform: scale(1.02);
}

/* Action buttons */
.action-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  padding: 12px;
  background: rgba(255,255,255,0.03);
  border-radius: 12px;
  transition: all .22s ease;
  border: 1px solid rgba(255,255,255,0.03);
}
.action-btn:hover {
  background: rgba(255,255,255,0.06);
  box-shadow: 0 8px 22px rgba(59,130,246,0.06);
}

/* Assets cards */
.asset-card {
  padding: 14px;
  border-radius: 12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.03);
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: transform .2s ease, box-shadow .2s ease;
}
.asset-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 14px 30px rgba(2,6,23,0.5);
}

/* Toast */
#toast {
  position: fixed;
  top: 16px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(17,24,39,0.95);
  color: #fff;
  padding: 12px 18px;
  border-radius: 12px;
  box-shadow: 0 8px 30px rgba(2,6,23,0.6);
  font-size: 14px;
  opacity: 0;
  pointer-events: none;
  transition: all .28s ease;
  z-index: 10000;
}
#toast.show { opacity: 1; pointer-events: auto; }

/* Bottom nav */
.bottom-nav {
  position: fixed;
  bottom: 12px;
  left: 12px;
  right: 12px;
  background: rgba(15,23,42,0.6);
  backdrop-filter: blur(14px);
  border-radius: 14px;
  padding: 10px 14px;
  border: 1px solid rgba(255,255,255,0.04);
  z-index: 100;
}

/* small */
.small-muted { color: rgba(255,255,255,0.55); font-size: 13px; }
</style>
</head>
<body>
<!-- Toast -->
<div id="toast" aria-hidden="true"></div>

<!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
<main id="main-menu" class="p-4" style="display: none;">
  <div class="max-w-xl mx-auto space-y-4">

    <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
    <div class="glass p-4 flex items-center gap-3">
      <img id="user-photo" src="https://via.placeholder.com/80" alt="avatar" class="w-12 h-12 rounded-full border border-white/10 object-cover">
      <div class="flex-1 min-w-0">
        <div id="user-name" class="text-base font-semibold truncate">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <div id="wallet-short" class="text-xs small-muted mt-1" style="display: none;"></div>
      </div>
      <button onclick="showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫–æ—Ä–æ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã')" class="p-3 rounded-xl bg-white/5 active:bg-white/10 btn-glow">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
          <line x1="3" y1="6" x2="21" y2="6"/>
          <line x1="3" y1="12" x2="21" y2="12"/>
          <line x1="3" y1="18" x2="21" y2="18"/>
        </svg>
      </button>
    </div>

    <!-- –ë–∞–ª–∞–Ω—Å -->
    <div class="glass text-center py-8">
      <div class="text-4xl mb-1" id="balance-amount">$0.00</div>
      <div class="text-sm small-muted">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</div>
    </div>

    <!-- –î–µ–π—Å—Ç–≤–∏—è -->
    <div class="grid grid-cols-4 gap-2">
      <button class="action-btn" onclick="showToast('–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞')">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="22" y1="2" x2="11" y2="13"/>
          <polygon points="22 2 15 22 11 13 2 9 22 2"/>
        </svg>
        <span class="text-xs small-muted">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</span>
      </button>

      <button class="action-btn" onclick="showToast('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ')">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <polyline points="19 12 12 19 5 12"/>
        </svg>
        <span class="text-xs small-muted">–ü–æ–ª—É—á–∏—Ç—å</span>
      </button>

      <button class="action-btn" onclick="showToast('–ë–∏—Ä–∂–∞ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞')">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
        </svg>
        <span class="text-xs small-muted">–ë–∏—Ä–∂–∞</span>
      </button>

      <button class="action-btn" onclick="showToast('–û–±–º–µ–Ω —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω')">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="17 1 21 5 17 9"/>
          <path d="M3 11V9a4 4 0 0 1 4-4h14"/>
          <polyline points="7 23 3 19 7 15"/>
          <path d="M21 13v2a4 4 0 0 1-4 4H3"/>
        </svg>
        <span class="text-xs small-muted">–û–±–º–µ–Ω</span>
      </button>
    </div>

    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∞–∫—Ç–∏–≤–æ–≤ -->
    <div class="flex justify-between items-center text-sm">
      <span class="text-white/70 font-medium">–ê–∫—Ç–∏–≤—ã</span>
      <button onclick="showToast('–§—É–Ω–∫—Ü–∏—è —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ üöÄ')" class="text-sky-400 active:text-sky-300 text-xs">
        –°–∫—Ä—ã—Ç—å –º–µ–ª–∫–∏–µ –±–∞–ª–∞–Ω—Å—ã
      </button>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–æ–≤ -->
    <div id="assets" class="space-y-3">
      <!-- –ü—Ä–∏–º–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏: TON -->
      <div class="asset-card">
        <div>
          <div class="text-sm font-medium">TON</div>
          <div class="small-muted text-xs">Toncoin</div>
        </div>
        <div style="text-align:right">
          <div id="ton-balance-small" class="font-semibold">0 TON</div>
          <div class="small-muted text-xs" id="ton-fiat-small">$0.00</div>
        </div>
      </div>
      <!-- –¥—Ä—É–≥–∏–µ —Ç–æ–∫–µ–Ω—ã/–∞–∫—Ç–∏–≤—ã (–ø–æ–∫–∞ —Å—Ç–∞—Ç–∏—á–Ω–æ) -->
    </div>

  </div>
</main>

<!-- –ü–∞–Ω–µ–ª—å TON Connect (–≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ) -->
<div id="ton-panel">
  <div class="panel-content">
    <button id="close-ton" class="absolute top-4 right-4 text-white/60 active:text-white text-2xl leading-none" onclick="document.getElementById('ton-panel').classList.remove('active')">&times;</button>
    <div class="flex justify-center mb-6">
      <div class="w-20 h-20 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-lg shadow-blue-500/50">
        <svg width="48" height="48" viewBox="0 0 56 56" fill="white" aria-hidden="true">
          <path d="M28 56C43.464 56 56 43.464 56 28C56 12.536 43.464 0 28 0C12.536 0 0 12.536 0 28C0 43.464 12.536 56 28 56Z"/>
          <path d="M37.56 15.63H18.44"/>
        </svg>
      </div>
    </div>
    <h3 class="text-center font-semibold mb-1">–ü–æ–¥–∫–ª—é—á–∏—Ç–µ TON-–∫–æ—à–µ–ª—ë–∫</h3>
    <p class="small-muted text-center mb-6">–ü–æ–¥–∫–ª—é—á–∏–≤ –∫–æ—à–µ–ª—ë–∫, –≤—ã —Å–º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TON –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∏ –ø–æ–∫—É–ø–æ–∫</p>
    <div class="flex gap-3">
      <button id="connect-ton-btn" class="btn-primary flex-1">–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª—ë–∫</button>
      <button id="skip-ton-btn" class="btn-primary" style="background:transparent; border:1px solid rgba(255,255,255,0.06)">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
    </div>
    <div class="text-center small-muted mt-4">@SendingCrypto_bot</div>
  </div>
</div>

<!-- Bottom nav (–≤–∏–∑—É–∞–ª—å–Ω–æ) -->
<nav class="bottom-nav glass">
  <div class="max-w-xl mx-auto flex justify-between items-center">
    <div class="nav-btn active">
      <div class="text-xs">–ì–ª–∞–≤–Ω–∞—è</div>
    </div>
    <div class="nav-btn">
      <div class="text-xs">–ü–µ—Ä–µ–≤–æ–¥—ã</div>
    </div>
    <div class="nav-btn">
      <div class="text-xs">–ò—Å—Ç–æ—Ä–∏—è</div>
    </div>
    <div class="nav-btn">
      <div class="text-xs">–ü—Ä–æ—Ñ–∏–ª—å</div>
    </div>
  </div>
</nav>

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º TonConnect UI (–ª–æ–∫–∞–ª—å–Ω–æ –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è) -->
<script src="./tonconnect-ui.min.js"></script>
<script>
/*
  –õ–æ–≥–∏–∫–∞:
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º TonConnectUI –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ.
  - –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å–æ–∑–¥–∞—ë—Ç—Å—è (–∏ –µ—Å—Ç—å backup-–ø–∞–Ω–µ–ª—å).
  - –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –ø–æ–ª—É—á–∞–µ–º –∞–¥—Ä–µ—Å –∏ –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ toncenter API.
  - –ë–∞–ª–∞–Ω—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –±–ª–æ–∫–µ "–û–±—â–∏–π –±–∞–ª–∞–Ω—Å" –∏ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ TON.
  - –í—Å—ë –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è ‚Äì CSS, –∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ DOM —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞.
*/

const MANIFEST_URL = 'https://sendingcrypto.vercel.app/tonconnect-manifest.json';
const TONCENTER_BALANCE_ENDPOINT = 'https://toncenter.com/api/v2/getAddressBalance';

// —É–¥–æ–±–Ω—ã–π toast
function showToast(text) {
  const toast = document.getElementById('toast');
  toast.textContent = text;
  toast.classList.add('show');
  clearTimeout(toast._t);
  toast._t = setTimeout(()=> toast.classList.remove('show'), 3000);
}

async function fetchTonBalance(address) {
  try {
    const res = await fetch(`${TONCENTER_BALANCE_ENDPOINT}?address=${encodeURIComponent(address)}`);
    const json = await res.json();
    if (json && json.ok && json.result) {
      // –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ TON
      return Number(json.result) / 1e9;
    } else {
      console.warn('toncenter returned', json);
      return 0;
    }
  } catch (e) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ TON', e);
    return 0;
  }
}

function updateBalanceUI(tonValue) {
  // –û–±—â–∏–π –±–∞–ª–∞–Ω—Å
  const main = document.getElementById('balance-amount');
  // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤ TON –∏ –≤ USD-–ø–æ–¥—Å–∫–∞–∑–∫–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ‚Äî –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å API –∫—É—Ä—Å–∞)
  main.textContent = tonValue.toFixed(4) + ' TON';
  main.classList.add('balance-glow');

  // –û–±–Ω–æ–≤–∏–º –∫–∞—Ä—Ç–æ—á–∫—É TON
  const small = document.getElementById('ton-balance-small');
  if (small) small.textContent = tonValue.toFixed(4) + ' TON';

  // (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –º–æ–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å fiat –ø–æ –∫—É—Ä—Å—É, –Ω–æ —Å–µ–π—á–∞—Å –æ—Å—Ç–∞–≤–∏–º —Å—Ç–∞—Ç–∏—á–Ω–æ
  const fiat = document.getElementById('ton-fiat-small');
  if (fiat) fiat.textContent = '$' + (tonValue * 1.7).toFixed(2); // –ø—Ä–∏–º–µ—Ä: –≥—Ä—É–±—ã–π –∫—É—Ä—Å (–ø–æ—Å—Ç–∞–≤—å —Ä–µ–∞–ª—å–Ω—ã–π API –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏)
}

document.addEventListener('DOMContentLoaded', async () => {
  try {
    // Telegram WebApp ready (–µ—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Telegram)
    if (window.Telegram?.WebApp) {
      try { window.Telegram.WebApp.ready(); } catch(e) { console.warn('Telegram ready failed', e); }
      // show user info if exists
      if (window.Telegram.WebApp.initDataUnsafe?.user) {
        const u = window.Telegram.WebApp.initDataUnsafe.user;
        document.getElementById('user-name').textContent = (u.first_name || '') + (u.last_name ? ' ' + u.last_name : '');
        if (u.photo_url) document.getElementById('user-photo').src = u.photo_url;
      }
    }

    // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
    document.getElementById('main-menu').style.display = 'block';

    // –ï—Å–ª–∏ TonConnect UI –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ–º
    if (!window.TON_CONNECT_UI || !window.TON_CONNECT_UI.TonConnectUI) {
      console.error('TonConnect UI not found');
      showToast('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ SDK');
      // –Ω–æ –º—ã –≤—Å—ë –∂–µ –ø–æ–∫–∞–∂–µ–º –ø–∞–Ω–µ–ª—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–∫–Ω–æ–ø–∫–∞)
      document.getElementById('ton-panel').classList.add('active');
      return;
    }

    // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TonConnect UI
    const tonConnect = new TON_CONNECT_UI.TonConnectUI({
      manifestUrl: MANIFEST_URL
    });

    // –ü—Ä–∏–≤—è–∑–∫–∞ –∫–Ω–æ–ø–æ–∫ –ø–∞–Ω–µ–ª–∏
    const connectBtn = document.getElementById('connect-ton-btn');
    const skipBtn = document.getElementById('skip-ton-btn');
    const tonPanel = document.getElementById('ton-panel');

    // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç —Å—Ä–∞–∑—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å
    connectBtn.addEventListener('click', async () => {
      try {
        const session = await tonConnect.connectWallet();
        // session: { account: { address, name? }, ... }
        if (session && session.account && session.account.address) {
          const addr = session.account.address;
          document.getElementById('wallet-short').style.display = 'block';
          document.getElementById('wallet-short').textContent = addr.slice(0,8) + '...' + addr.slice(-4);
          showToast('–ö–æ—à–µ–ª—ë–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω');

          // –ü–æ–ª—É—á–∞–µ–º –±–∞–ª–∞–Ω—Å –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º
          const balance = await fetchTonBalance(addr);
          updateBalanceUI(balance);

          // –ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å
          tonPanel.classList.remove('active');
        } else {
          showToast('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞');
        }
      } catch (err) {
        console.error('connectWallet error', err);
        showToast('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞');
      }
    });

    skipBtn.addEventListener('click', () => {
      tonPanel.classList.remove('active');
      showToast('–ü—Ä–æ–ø—É—â–µ–Ω–æ');
    });

    // –¥–æ–±–∞–≤–∏–º –∫–Ω–æ–ø–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å–≤–µ—Ä—Ö—É (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø)
    const topConnect = document.createElement('button');
    topConnect.innerText = '–ü–æ–¥–∫–ª—é—á–∏—Ç—å TON –∫–æ—à–µ–ª—ë–∫';
    topConnect.className = 'btn-primary mt-4';
    topConnect.onclick = () => {
      document.getElementById('ton-panel').classList.add('active');
    };
    // –≤—Å—Ç–∞–≤–ª—è–µ–º –ø–æ–¥ –ø—Ä–æ—Ñ–∏–ª–µ–º
    const profile = document.querySelector('.glass.p-4.flex.items-center');
    if (profile && profile.parentNode) {
      profile.parentNode.insertBefore(topConnect, profile.nextSibling);
    }

    // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–∞–Ω–µ–µ –¥–∞–ª –¥–æ—Å—Ç—É–ø (—Ä–µ–¥–∫–æ) ‚Äî –ø–æ–ø—Ä–æ–±—É–µ–º –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å last session
    try {
      const last = await tonConnect.getWallets();
      if (Array.isArray(last) && last.length > 0) {
        const addr = last[0].account.address;
        document.getElementById('wallet-short').style.display = 'block';
        document.getElementById('wallet-short').textContent = addr.slice(0,8) + '...' + addr.slice(-4);
        // fetch balance
        const bal = await fetchTonBalance(addr);
        updateBalanceUI(bal);
      }
    } catch (e) {
      // –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
      console.debug('no previous wallets', e);
    }

  } catch (err) {
    console.error('Init error', err);
    showToast('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏');
  }
});
</script>
</body>
</html>
