<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
<title>SendingCrypto Bot</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
:root {
  --bg-1:#0b1220;
  --bg-2:#0f1724;
  --glass: rgba(255,255,255,0.02);
  --border: rgba(255,255,255,0.05);
  --glow: rgba(59,130,246,0.25);
  --glow-strong: rgba(59,130,246,0.55);
  --muted: rgba(255,255,255,0.65);
  --accent:#3b82f6;
}
body {
  background: linear-gradient(180deg, var(--bg-1), var(--bg-2));
  color:#fff;
  font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
  min-height:100vh;
  padding-bottom:100px;
  -webkit-font-smoothing:antialiased;
}
.glass {
  background: var(--glass);
  backdrop-filter: blur(12px) saturate(160%);
  border:1px solid var(--border);
  border-radius:16px;
  box-shadow:0 0 20px var(--glow);
  transition: all 0.3s ease;
}
.glass:hover {
  box-shadow:0 0 26px var(--glow-strong);
  transform:translateY(-2px);
}
.text-muted{color:var(--muted);}
#balance-amount {cursor:pointer; font-weight:700;}
/* bottom nav */
.bottom-nav{
  position:fixed;
  bottom:12px; left:12px; right:12px;
  background: rgba(255,255,255,0.02);
  backdrop-filter: blur(20px);
  border:1px solid rgba(255,255,255,0.05);
  border-radius:16px;
  display:flex;
  justify-content:space-around;
  padding:10px 0;
  box-shadow:0 0 20px rgba(2,6,23,0.6);
  z-index:100;
}
.nav-item{
  display:flex;
  flex-direction:column;
  align-items:center;
  color:var(--muted);
  font-size:12px;
  transition:all .3s ease;
}
.nav-item svg{transition:all .3s ease;}
.nav-item.active{color:var(--accent);}
.nav-item.active svg{stroke:var(--accent); filter: drop-shadow(0 0 6px var(--glow-strong));}
.nav-item:hover{color:#fff;}
.nav-item:hover svg{stroke:#fff;}
</style>
</head>

<body>
<main class="max-w-xl mx-auto p-4 space-y-4">
  <div class="glass p-4 flex items-center gap-3">
    <img id="user-photo" src="https://via.placeholder.com/80" class="w-12 h-12 rounded-xl border border-white/10 object-cover">
    <div class="flex-1 min-w-0">
      <div id="user-name" class="text-base font-semibold truncate">Загрузка...</div>
      <div id="wallet-short" class="text-xs text-muted mt-1" style="display:none;"></div>
    </div>
  </div>

  <div class="glass text-center py-8">
    <div id="balance-amount" class="text-4xl mb-1">$0.00</div>
    <div class="text-sm text-muted">Общий баланс</div>
  </div>

  <div class="grid grid-cols-4 gap-3">
    <button class="glass py-3 flex flex-col items-center text-sm text-muted hover:text-white transition">
      <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
      Отправить
    </button>
    <button class="glass py-3 flex flex-col items-center text-sm text-muted hover:text-white transition">
      <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><polyline points="19 12 12 19 5 12"/></svg>
      Получить
    </button>
    <button class="glass py-3 flex flex-col items-center text-sm text-muted hover:text-white transition">
      <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
      Биржа
    </button>
    <button class="glass py-3 flex flex-col items-center text-sm text-muted hover:text-white transition">
      <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="17 1 21 5 17 9"/><path d="M3 11V9a4 4 0 0 1 4-4h14"/><polyline points="7 23 3 19 7 15"/><path d="M21 13v2a4 4 0 0 1-4 4H3"/></svg>
      Обмен
    </button>
  </div>

  <div class="flex justify-between items-center text-sm text-muted font-medium">
    <span>Активы</span>
    <button class="text-blue-400 text-xs">Скрыть мелкие балансы</button>
  </div>
  <div id="assets" class="space-y-3"></div>
</main>

<!-- Bottom navigation -->
<nav class="bottom-nav">
  <button class="nav-item active" data-tab="home">
    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
    Главная
  </button>
  <button class="nav-item" data-tab="transfer">
    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
    Переводы
  </button>
  <button class="nav-item" data-tab="history">
    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
    История
  </button>
  <button class="nav-item" data-tab="profile">
    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
    Профиль
  </button>
</nav>

<div id="toast" class="fixed top-4 left-1/2 -translate-x-1/2 bg-black/70 px-4 py-2 rounded-xl text-sm opacity-0 transition">...</div>

<script>
const toast=document.getElementById('toast');
function showToast(t){toast.textContent=t;toast.style.opacity=1;clearTimeout(toast._t);toast._t=setTimeout(()=>toast.style.opacity=0,2500);}

// нижняя навигация активатор
document.querySelectorAll('.nav-item').forEach(btn=>{
  btn.addEventListener('click',()=>{
    document.querySelectorAll('.nav-item').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    showToast(btn.textContent.trim());
  });
});

// баланс TON+Binance API
const TON_API='https://toncenter.com/api/v2/getAddressBalance';
const BINANCE_API='https://api.binance.com/api/v3/ticker/price?symbol=';
let tonBalance=0, tonPrice=0, fiatRates={USD:1,TRY:0,UAH:0,RUB:0};
let currencyCycle=['USDT','TON','TRY','UAH','RUB'], currencyIndex=0;
async function fetchTON(addr){
  const r=await fetch(`${TON_API}?address=${addr}`);
  const j=await r.json();
  return j.ok?Number(j.result)/1e9:0;
}
async function fetchBinance(symbol){
  const r=await fetch(BINANCE_API+symbol);
  const j=await r.json();
  return Number(j.price);
}
async function fetchRates(){
  fiatRates.TRY=await fetchBinance('USDTTRY');
  fiatRates.UAH=await fetchBinance('USDTUAH');
  fiatRates.RUB=await fetchBinance('USDTRUB').catch(()=>0);
}
async function updateBalance(){
  const wallet=localStorage.getItem('ton_wallet');
  if(!wallet)return;
  tonBalance=await fetchTON(wallet);
  tonPrice=await fetchBinance('TONUSDT');
  await fetchRates();
  displayBalance();
}
function displayBalance(){
  const cur=currencyCycle[currencyIndex];
  const el=document.getElementById('balance-amount');
  if(cur==='TON')el.textContent=`${tonBalance.toFixed(3)} TON`;
  else{
    const usd=tonBalance*tonPrice;
    const val=cur==='USDT'?usd:(usd*(fiatRates[cur]||1));
    const symbol=cur==='USDT'?'$':cur;
    el.textContent=`${symbol}${val.toFixed(2)}`;
  }
}
document.getElementById('balance-amount').addEventListener('click',()=>{
  currencyIndex=(currencyIndex+1)%currencyCycle.length;
  displayBalance();
});

// пример адреса (можно удалить когда подключишь TonConnect)
localStorage.setItem('ton_wallet','EQBexampleWallet1234567890');
updateBalance();
setInterval(updateBalance,60000);
</script>
</body>
</html>
